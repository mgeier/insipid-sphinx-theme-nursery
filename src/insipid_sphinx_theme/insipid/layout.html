{% extends "basic/layout.html" %}


{% block css %}
{{ super() }}
{% if READTHEDOCS|tobool and render_sidebar %}
    <link rel="stylesheet" href="{{ pathto('_static/readthedocs-sidebar.css', 1) }}" type="text/css" />
{% endif %}
{% endblock %}


{% block scripts %}
{{ super() }}
    <script defer src="{{ pathto('_static/topbar.js', 1) }}"></script>
{% if render_sidebar %}
    <script defer src="{{ pathto('_static/sidebar.js', 1) }}"></script>
{% endif %}
{% endblock %}


{% block extrahead %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
{% endblock %}


{% block body_tag %}
  <body class="no-js{% if render_sidebar %} sidebar-visible{% endif %}">
{% endblock %}


{% block header %}
    <script type="text/javascript">
        var body = $(document.body);
        body.removeClass('no-js');
        body.addClass('js');
{% if render_sidebar %}
        try {
            var sidebar = localStorage.getItem('sphinx-sidebar');
            body.removeClass('sidebar-visible');
            body.addClass('sidebar-' + sidebar);
        } catch(e) {
        }
        try {
            $(':root').css('--sidebar-width', localStorage.getItem('sphinx-sidebar-width'));
        } catch(e) {
        }
{% endif %}
    </script>

    <div id="scroll-container">
        <div id="main-column">
            <div id="topbar-placeholder">
                <div id="topbar-container">
                    <div id="menu-bar">
                        <div class="left-buttons">
{% if render_sidebar %}
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Sidebar" aria-label="Toggle Sidebar" aria-controls="sidebar">
                              {% include 'icons/sidebar-toggle.svg' %}
                            </button>
{% endif %}
{% if pagename != "search" %}
                            <button id="search-toggle" class="icon-button" type="button" title="Search" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                              {% include 'icons/search.svg' %}
                            </button>
{% endif %}
                        </div>

                        {# TODO: docstitle vs. shorttitle #}
                        <h1 class="menu-title">{{ docstitle|striptags|e }}</h1>

                        <div class="right-buttons">
                            {#{{#if git_repository_url}}#}
                            {#
                            <a href="{{git_repository_url}}" title="Git repository" aria-label="Git repository">
                                <i id="git-repository-button" class="fa {{git_repository_icon}}"></i>
                            </a>
                            #}
                            {#{{/if}}#}
                        </div>
                    </div>

{% if pagename != "search" %}
                {#
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                </div>
                #}

<div id="searchbox" role="search">
  <div id="searchform" class="hidden">
  {#
  <h3 id="searchlabel">{{ _('Quick search') }}</h3>
  -->
  #}
    <form class="search" action="{{ pathto('search') }}" method="get">
      <!--
        aria-labelledby="searchlabel"
      -->
      <input type="search" id="searchbar" name="q" placeholder="{{ _('Enter search terms ...') }}" />
      <input type="submit" value="{{ _('Go') }}" />
    </form>
  </div>
</div>

{% endif %}

            </div>
        </div>

{# TODO: config option to disable this? #}
{% if theme_body_max_width != None %}
            <nav aria-label="Page navigation">
    {% if prev %}
                    <a href="{{ prev.link|e }}" class="nav-icon previous" title="{{ prev.title|striptags|e }}" aria-label="Previous page" aria-keyshortcuts="Left">
                      {% include 'icons/previous.svg' %}
                    </a>
    {% endif %}
    {% if next %}
                    <a href="{{ next.link|e }}" class="nav-icon next" title="{{ next.title|striptags|e }}" aria-label="Next page" aria-keyshortcuts="Right">
                      {% include 'icons/next.svg' %}
                    </a>
    {% endif %}
            </nav>
{% endif %}
{% endblock %}


{% block sidebarlogo %}
{# We abuse this block to inject the sidebar-resize-handle #}
{% if render_sidebar %}
      <div id="sidebar-resize-handle"></div>
{% endif %}
{{ super() }}
{% endblock %}


{#
{% block relbar1 %}{% endblock %}
#}


{#
{% block content %}
{{ super() }}
{% endblock %}
#}


{#
{% block document %}
{{ super() }}
{% endblock %}
#}


{#
{% block relbar2 %}{% endblock %}
#}


{% block footer %}
{{ super() }}
        </div>
    </div>
{% if render_sidebar %}
                <!-- TODO: provide a re-usable function for this in .js file? -->
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.querySelector('.sphinxsidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    /*
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                    */
                </script>
{% endif %}
{% endblock %}
